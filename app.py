import streamlit as st
import pandas as pd
from datetime import datetime
import os

# Carpeta de guardado
SAVE_FOLDER = "OneDriveSync"
os.makedirs(SAVE_FOLDER, exist_ok=True)

# Lista de productos con c√≥digo y nombre
productos = [
    "AG-655244019440 - 5 SEGUNDOS PARA GANAR",
"AG-JCA3617 - A SUS MARCAS ",
"AG-653569120346 - ACTION MAN DEEP SEA ATTAK",
"AC-ST32388 - ACUARELAS ",
"AM-8018190033755 - ALBUM QATAR",
"AM-7500383098456 - ALMOHADA PARA CUELLO",
"AC-ANILFANT - ANILLO FANTASIA",
"AC-H1540 - ARENA",
"AC-TO2238 - ARO CEL ",
"AG-9284648GF - AUDIFONO GAMER VARIOS ",
"AG-AU068804 - AUDIFONO MACARON",
"AG-X00364E183 - AUDIFONOS INALAMBRICO E18",
"AC-AUDVAR19 - AUDIFONOS VARIOS ",
"AM-E7377 - AVENGERS FLEX SURTIDO",
"AC-013429841529 - AVION UNICEL",
"AC-BM2861936 - BALERO MADERA",
"AM-22101 - BALON DE FUTBOL SOCCER ",
"AM-778988545669 - BALON DE VOLEYBALL",
"AM-7502276170881 - BALON STARTER ",
"AM-7503009226684 - BALON VARIOS MODELOS",
"AM-655244027544 - BANANAGRAMS",
"AM-BJPK001 - BARAJA POKER VARIOS PERSONAJES ",
"AM-027084930771 - BARBIE PRINCESA ",
"AJ-H2205 - BARRA DE SONIDO DE 2.0",
"AC-155V - BASKETBALL ",
"AM-655244027704 - BASTA EN TIN ",
"AC-BTCPVP080916 - BAT CON PELOTA VARIOS PERSONAJES",
"AG-BM1987 - BATIDORA DE MANO",
"AC-045557866976 - BAUL GROSERY GANG METALICO",
"AG-JCA3303 - BINGO FOIL",
"AC-66777029 - BLISTER ROBOT ",
"AC-SH1309921 - BLOQUES PARA ARMAR",
"AG-6911400376873 - BOB ESPONJA STRETCHPANTS",
"AD-025046150137 - BOCADIN",
"AG-ELE000726 - BOCINA BLUETOOTH VARIOS MODELOS ",
"AC-7501585594203 - BOLIGRAFO DELGADO FULANITOS",
"AC-18311215525 - BOLSA P/CELULAR CONTRA AGUA",
"AM-0100189O027 - BOLSA SNOOPY",
"AG-630509862535 - BOP IT CLASICO",
"AC-973727468 - BORRADOR SLICE",
"AM-IW776344 - BOTELLA MED MOTIVACION ",
"AC-85600986 - BRILLO ",
"AC-7791975 - BRILLO CON BOLITAS ",
"AC-7505315100723 - BROCHE METALICO FULANITOS",
"AD-62221056793 - BUBBALOO XTREME",
"AD-797038010445 - BUBLI BUBLI",
"AD-074323011616 - BUBULUBU MINI",
"AM-7506315302062 - BUHOS ",
"AC-730002010553 - BURBUGUANTE",
"AC-JUB000131 - BURBUJA CH ",
"AC-1181B - BURBUJA ESPADA VARIOS COLORES ",
"AC-117V - BURBUJAS 3 EN 1",
"AC-CACHDVM01 - CACHIBOL DISNEY VARIOS MODELOS",
"AD-7501002201103 - CALAVERA MALVAVISCO",
"AC-7501585591035 - CALCOMANIA FULANITOS",
"AC-7502241990001 - CALCULADORA BASICA ",
"AC-CAMVISORVM - CAMARA CON VISIOR VARIOS MODELOS",
"AC-7500383104956 - CANASTA CON PELOTA VARIOS",
"AM-FA1112 - CANGURERA 2",
"AC-CPAGUA - CAPSULA CON ANMAL ",
"AD-18804052064 - CARAMELO DE MENTA",
"AG-0322444041136 - CARAS Y GESTOS ",
"AC-CB998165 - CARRO BAILARIN ",
"AM-4891861277122 - CARRO DEPORTIVO HOT WHEELS",
"AM-CARTJV0219 - CARTERA JUVENIL",
"AJ-6944138969719 - CASA DE CAMPA√ëA",
"AM-7501950076792 - CASE UNIVERSAL PARA TABLETA C017",
"AG-8410779062017 - CAZA BICHOS",
"AC-261012CD - CEPILLO DE DIENTES VARIOS PERSON",
"AC-CERE001 - CEREBRO ",
"AD-762220177051 - CHICLE BUBBALOO",
"AM-7501585591431 - CILINDRO FULANITOS",
"AM-B00N4ONUZG - CLUEDO",
"AC-CP86026 - COMPAHITO ",
"AG-52288567 - COSTAL BOX INFLABLE ",
"AD-719886120088 - CRAYON",
"AJ-RC602 - CREPERA ANTIHADERENTE",
"AC-346100837 - CUBO ARMAR CON ORILLAS ",
"AC-CLE27846 - CUBO LEGO PARA ARMAR",
"AG-630509528073     - DESTREZA",
"AC-4714648000020 - DIARIO C/ CANDADO ",
"AC-LE2233 - DINO CRESENCIO",
"AC-DGS01883 - DINO EGG SLIME ",
"AC-3705643 - DINOSAURIO DISCOVER ",
"AC-DJFALT03 - DISNEY JUEGO DE MESA LOTERIA VAR",
"AC-DJCME14 - DISNEY JUEGO DE MESA MEMORIA VAR",
"AG-655244024215 - DISNEY MANIA",
"AM-778988391600 - DOMINO DOBLE",
"AG-55244010393 - DOMINO FRIDA",
"AD-7501345700257 - DRAGONZITOS",
"AJ-6911400364811 - DRONE FORCE ANGLER ATTACK",
"AD-DUL1000 - DULCE VARIADO",
"AD-252671 - DUVALIN",
"AJ-840080593524 - ECO DOT 4TA GENERACION ",
"AG-7506176986979 - EMOSHIONATO VARIOS MODELOS ",
"AM-655244014544 - EN LA TORRE CAJA DE CARTON",
"AC-8018190029833 - ESTAMPAS QATAR",
"AC-ESTMEVP2106 - ESTUCHE METALICO VARIOS PERSONAJ",
"AC-08165 - EYE POP MOSNTER ",
"AC-7506288725848 - FASHION ROSE",
"AM-4907953801455 - FIGURA DE COLECCION CAPCOM",
"AM-887961779882 - FIGURA FLEXIBLE LIGA DE LA JUSTI",
"AG-FKPVM021215 - FIGURA FUNKO POP VARIOS MODELOS ",
"AC-HTT111 - FIGURA LUMINOSA VARIOS ",
"AM-778988330906 - FIGURA PAW PATROL",
"AC-DJTS9J2 - FIGURA PEGAJOSA VARIOS MODELOS ",
"AC-BH754322 - FLASHING MOUTH",
"AC-YW463875 - FLIP CARS 2 EN 1 VEHICULO ",
"AG-6926262900992 - FLOTADOR MANDALAS",
"AC-7500383105932 - FOAMI MOLDEABLE ",
"AG-630509990788 - FOOSKETBALL",
"AG-5010993962891 - FORNITE UPGRADE SHARK",
"AJ-7500383105468 - FREIDORA DE AIRE ",
"AC-DJTS4122 - FRISBEE 3 PIEZAS ",
"AC-12J19468 - FRISBEE ABRE CIERRA ",
"AG-630509850921 - FROZEN PLAY DOH MISTERIO",
"AD-754177500695 - FRUTAFFY",
"AM-655244019679 - FUCHI GUEBOS",
"AG-5010994148102 - FUR REAL LIL WILDS",
"AG-630509897308 - FUR REAL WALKALOTS",
"AC-7502214150043 - FUTBOLITO ",
"AG-704551409748 - FUTBOLITO MESA",
"AC-B266 - GALLINA GRANDE ",
"1000000001 - Game Card",
"AM-2022051200718 - GARRA DINOSAURIO ",
"AG-8410779038005 - GEL A PEEL",
"AC-845218010744 - GLOBO DE AGUA",
"AC-GOAN231213 - GOMA ANIMALES ",
"AC-JUB000154 - GOMA ERASER ",
"AC-462462143716 - GOMAS VARIOS MODELOS ",
"AM-GE0001 - GORRAS EQUIPOS",
"AC-96509 - GROW UP ANIMAL GIGANTE ",
"AG-045557815134 - GRUMBLIES",
"AD-724869005142 - GUMMY POP",
"AC-9326243578115 - GUSANO C/LUZ MEDIANO",
"AG-778988150900 - HEAD BANZ JR",
"AG-778988413586 - HEADBANZ PRINCESAS",
"AC-HELBROM001 - HELADO BROMA VARIOS MODELOS ",
"AJ-194735028962 - HOT WHEELS DRAGON",
"AC-HGK14 - HOT WHEELS EXOTIC",
"AG-GCP26 - HOTWHEELS PISTA MARIO KART",
"AC-285612 - HUEVO DE DINASAURIO CHICO ",
"AC-7502223022362 - HUEVO DE DINOSAURIO MEDIANO ",
"AM-H0070 - HUMIDIFICADOR DE LUZ",
"AG-887961713787 - HW PISTA CAMPEON DE LAS ALTURAS",
"AG-655244017163 - IGLOOMANIA",
"AG-6926262901579 - INFLABLE CACTUS",
"AG-6942138967272 - INFLABLE PORTA VASOS CACTUS",
"AG-JCA3302 - INGENIO ",
"AG-653569288992 - IRON MAN ",
"F-7502262200233 - JARABE SLUSH",
"AC-JA386455 - JUEGO ARMAR VARIOS ",
"AM-655244029166 - JUEGO BOLA MAGICA",
"AC-SWA1738 - JUEGO DE AGUA ",
"AC-7500383129099 - JUEGO DE CANASTA",
"AC-JGTVM1502 - JUEGO DE GATO VARIOS MODELOS",
"AM-JCA1991 - JUEGO DE LOS FIDEOS",
"AG-PS3GAME01 - JUEGO DE PS3",
"AG-XBOXGAME360 - JUEGO DE XBOX 360",
"AM-655244012816 - JUEGO EQUILIBRIO PEPPA MADERA",
"AG-655244024178 - JUEGO MARVEL HEX ",
"AC-75001386109169 - JUGUETE DE RESORTE CABEZON ",
"AG-778988361849     - JUMANJI",
"AC-6971243713931 - KAWAI SOAP ",
"AD-80052463 - KINDER DELICE",
"AG-778988127896 - KINETIC SAND ARENA METALICA",
"AD-DUA000005 - KISSES HERSHEY",
"AM-029116952249 - KIT FROZEN 2 PARA VESTIR",
"AD-074323096989 - KRANKY",
"AC-LAB001 - LABIAL VARIOS ",
"AM-LP0044 - LAMPARA DE PLASTICO",
"AC-7500383129150 - LANZA AVIONES",
"AM-7502021424818 - LANZADOR GLOBOS DE AGUA",
"AC-LAPMTVM22 - LAPICERA METALICAVARIOS MODELOS ",
"AC-4007817161029 - LAPIZ ESCOLAR FULANITOS",
"AC-7501969790627 - LAPIZ FLEXIBLE",
"AC-91887557 - LIBRETA CON ACTIVIDADES ",
"AC-7501585594463 - LIBRETA CUADRADITA",
"AC-6909366215032 - LIBRO MAGICO ",
"AC-LB32PAGVM - LIBROS CON CRAYOLA 32PAG VARIOS ",
"AC-9238947 - LIGAS PARA EL CABELLO ",
"AG-887961917574 - LITTLE PEOPLE THE ROLLING STONE ",
"AM-630509604722 - LITTLE PET SHOP PELUCHE ",
"AC-1478548 - LLAVERO JUEGO ",
"AC-LLAVM001 - LLAVERO VARIOS MODELOS JR ",
"AM-0035051576419 - LOL DELUXE 2 MU√ëECAS",
"AM-655244000011 - LOTERIA CLASICA ",
"AG-887961991840 - MAESTROS DEL UNIVERSO SURTIDO",
"AD-7502225961379 - MALVALLENO MIX",
"AM-JCA1922 - MANDALAS ATERCIOPELADO",
"AC-SGZH7 - MANITA CON ANILLOS DE LUZ",
"AG-730002007140 - MAQUINA DE RASPADOS",
"AG-778988391518 - MAQUINA DE U√ëAS PORTATIL",
"AG-40053 - MARATON CINEMEX ",
"AC-MFVM120213 - MARCO PARA FOTOS VARIOS MODELOS",
"AC-TY0709 - MAROMERO",
"AM-655244031923 - MARVEL LUCHA INFINITA",
"AC-32Y78 - MAZE MINI ",
"AC-M653 - MEDUSA CON LUZ ",
"AG-JCA3626 - MEJOR PEOR AMIGO ",
"AG-730002010935 - MEME MANIA",
"AM-JCA2918 - MEMORIA LONCHERA DRAGON BALL SUP",
"AM-65524402772 - MEMORIA LONCHERA MINION",
"AD-7503027878049 - MENTOS",
"AG-7501717858005 - MICROFONO BOCINA",
"AD-76350612712 - MINI CHUPA CHUPS",
"AD-7501024529483 - MINI HERSHEYS",
"AC-013429916043 - MINI LIBROS PARA DIBUJAR ",
"AD-7501000664368 - MINI MAMUT",
"AJ-RC23G - MINI PANINI GRILL",
"AJ-5576MYT - MINI PORTERIA DE FUTBOL",
"AJ-RC4WG - MINI REFRIGERADOR BLANCO CON VER",
"AG-RC88 - MINI WAFFLERA",
"AD-980009935 - MINI WINIS ACIDITOS",
"AC-55101507 - MIRA Y COLOREA ",
"AG-7508000152260 - MOCHILA CATARINA ",
"AG-7500351006834 - MOCHILA ESCOLAR VARIOS MODELOS",
"AG-FA1105 - MOCHILA SIRENA",
"AD-7501088210617 - MONEDAS DE CHOCOLATE",
"AC-8888070206698 - MONEDERO AGUACATE ",
"AJ-E7030 - MONOPOLY ARCADE PACMAN ",
"AG-195166130347 - MONOPOLY DECODIFICADOR",
"AG-630509849338 - MONOPOLY FORTNITE",
"AG-630509971176 - MONOPOLY VILLANS",
"AG-887961822991 - MONOS LOCOS MINIONS 2",
"AG-1103MTR - MONTA√ëA RUSA",
"AM-4891861342622 - MOTOCICLETA SPIDER MAN ",
"AD-DUA000051 - MUECAS",
"AM-0350515788024 - MUNECA MAGICA ELLA ",
"AG-5010993911509 - MU√ëECA VILLANAS",
"AG-630509944439 - NERF COMANDER ",
"AG-630509948079 - NERF ELITE COMANDER ",
"AG-195166134598 - NERF FORNITE",
"AG-E9952 - NERF LANXADOR ELITE VILT ",
"AG-185166126982 - NERF ROBLOX",
"AG-630509990962 - NERF STEGOSMASH",
"AJ-195166180663 - NERF VIPER STRIKE",
"AM-630509602438 - NERFOOP",
"AG-JCA3618 - NI SI NI NO",
"AC-7502220923228 - NINJA PEGAJOSO",
"AM-655244029203 - NO TIRES A OTTO MINIONS 2",
"AC-035051553342 - NUM NOMS",
"AM-8056379104605 - OH MY GIF",
"AG-630509946600 - OPERANDO MINION",
"AD-76168285011 - PALETA LASER",
"AD-719886250019 - PALETA PELONETA",
"AD-7501011176904 - PALETA ROCKALETA",
"AD-75752801798 - PALETA VERO MIX",
"F-PAL0810 - PALOMITAS",
"F-PAL0811 - PALOMITAS MED",
"AD-74323077827 - PANDITAS",
"AD-72518160410 - PANZON MIX",
"AC-7500383021423 - PAPALOTE VARIOS MODELOS",
"F-001 - PAPAS",
"AC-PAPEJV - PAPELERIA VARIOS RUZ",
"AM-7500383107844 - PARAGUAS VARIOS MODELOS ",
"AG-655244029265 - PARTY AND FAMILY ",
"AJ-4891861336430 - PATIN DE LINEA VARIOS MOD",
"AJ-T371917 - PATINETA 4 RUEDAS",
"AG-A009 - PATINETA MED",
"AG-7506499314541 - PATINETA WAVEBOARD",
"AD-719886001017 - PELON PELORICO",
"AD-719886511066 - PELONETE",
"AM-1688AP - PELOTA PEGABLE CON UZ ",
"AC-6926262901074 - PELOTA PLAYA SANDIA",
"AC-JUB000052 - PELOTA STREES ",
"AG-8619722100817 - PELUCHE FROZEN ",
"AM-7501585594210 - PELUCHE FULANITA PINTORESCA",
"AM-12190319 - PELUCHE PAW PATROL",
"AD-759686651012 - PICA FRESA",
"AG-887961236125 - PICTIONARY",
"AG-887961972382 - PICTONARY AIR ",
"AG-7502220541330 - PIN BALL ALL STAR",
"AC-TY160623DS - PINBALL GRANDE",
"AM-7500383139135 - PINTAR MINNIE",
"AG-778988362143 - PISTA PAW PATROL",
"AC-DL7706 - PISTOLA DE AGUA MOD 3",
"AC-4891861285547 - PISTOLA DE DARDOS TOY STORY",
"AM-TY235001MX - PISTOLA LANZA BURBUJAS DISNEY",
"AM-194735006151 - PIZAR REMIX",
"AM-5010993726943 - PLAY DHO ARENA BRILLANTE",
"AG-630509836161 - PLAY DOH ARCOIRIS",
"AC-44965 - PLAY DOH INDIVIDUAL ",
"AG-195166168371 - PLAY DOH MILK",
"AG-8373651786 - PLAY DOH SLIME 3 PACK ",
"AC-83358814 - PLUMA MODELO SURTIDO ",
"AC-PM231213 - PLUMA MULTICOLOR",
"AC-6935685608163 - PLUMA TINTA INVISIBLE Y LAMPARA ",
"AM-27364SH - PLUMAS DE GEL NEON 36 PZ",
"AM-87652JDG - PLUMAS DE GEL NEON 48 PZ",
"AC-MARGUSGAT - PLUMAS GATO",
"AM-045557863999 - POP CORN POPPIN",
"AC-PIT10099987 - POP IT ",
"AC-PTB27354 - POP IT BALL ",
"AC-5428364538 - POP IT LLAVERO ",
"AC-3983465639 - POP TUBE ",
"AC-PORAU876 - PORTA AUDIFONOS ",
"AC-DG64103 - PORTA VASO VARIOS ",
"AC-DC22LPC01 - PORTAMINAS VARIOS MODELOS",
"AG-6942138982084 - PORTERIA",
"AG-032244045097 - PULGAS LOCAS ",
"AD-725226066660 - PULPARINDO",
"AC-PLREST  - PULSERA RESORTE ",
"AC-9734H - PULSERA SILICON WORMY ",
"AC-PAB000002 - PUNTILLAS",
"AG-655244017002 - QUE NARICES ",
"AM-3467452084731 - RACING CON LANZADOR",
"AC-7501969795479 - RAQUETA LANZA PELOTAS ",
"AC-7502221123962 - RAQUETA SPORTS",
"AC-7501969797268 - RAQUETAS PERSONAJES ",
"AJ-60509623112 - REALIDAD AUMENTADA IRON MAN ",
"AM-7503025960883 - RELOJ LED POOP",
"AM-7503025960869 - RELOJ LED SCRIBBLE",
"AM-7503025960920 - RELOJ ONIX COLOREABLE MAGIA",
"AM-SWA2341 - RELOJ PARED VARIOS ",
"AG-7503030007207 - RETRO MINI BEAST ",
"AC-610059412922 - RIKOCHET GRANDE CON FRASES ",
"AM-86J19376 - ROBOTIN TROMPO ",
"AD-840004027340 - ROLLIPS ICEE",
"AM-JCA3185 - ROMPECABEZA COLECCIONABLE CHUCKY",
"AM-JCA3182 - ROMPECABEZA COLLECIONABLE IT",
"AC-JR75 - ROMPECABEZA HELICE",
"AM-JCA3178 - ROMPECABEZA JACK",
"AM-7502001750715 - ROMPECABEZA PLASTILINA VARIOS",
"AC-RPCZ0903 - ROMPECABEZAS BOLSA VARIOS MODELO",
"AM-655244029005 - ROMPECABEZAS FRIENDS",
"AM-71483230008 - ROMPECABEZAS GLOBO HUEVOS DRAGON",
"AC-065410 - ROMPECABEZAS PARA COLOREAR ",
"AM-655244019310 - RUMMY SPEED",
"AC-MARBRAH - SACAPUNTA VARIOS MODELOS",
"AD-725181249016 - SALSAGHETI SKWINKLES",
"AD-7502226812564 - SALVAVIDAS",
"AG-022333905197 - SANDWICHERA",
"AJ-HY3030 - SARTEN ELECTRICO",
"AG-YT0521 - SCOOTER PATIN 3 RUEDAS",
"AG-SETM01 - SET CASCO Y PROTECCION AJUSTABLE",
"AG-778988369289 - SET DE JUEGO ORBEEZ",
"AM-JCA2895 - SET DE JUEGOS DE FIESTA ",
"AG-655244012939 - SET DE JUEGOS DE LUJO",
"AM-4891861197055 - SET DE TALLER CARS",
"AG-778988559406 - SET MECANO MECANICA",
"AM-7502020333937 - SET PELO TRENZADOR",
"AC-24657 - SILLAS PARA CELULAR ",
"AD-2518143610 - SKINKLES RELLENOS",
"AM-887961874839 - SLAMMER DC",
"AC-J2SR21 - SLIME BOTE ",
"AC-3961986Y - SLIME HUELLITAS ",
"AG-693824295215 - SLUBAN JGO CONSTRUCCION",
"AG-5010993742332 - SNAKE EYES",
"AM-5010993933471 - SPIDEY FRIENDS",
"AC-SJC9253727 - SQUEZZE JGO CALAMAR ",
"AC-C396 - SQUISHY MINI",
"AC-223J0129737 - SQUISHY VARIOS ",
"AD-75010592244346 - STICK CARLOS V",
"AC-7501585591257 - STICKERS FULANITOS",
"AM-655244028923 - STRANGER THINGS 500 PZ",
"AC-279983GYT - STRETCHY BANANAS ",
"AM-655244029418 - SUPER ELASTICO PIXAR ",
"AC-1149890 - SUPER PISTOL ",
"AM-778988551561 - SWIMWAYS BALON AMERICANO ",
"AD-DUA000004 - TAMBORIN",
"T-TARJ001 - TARJETAS",
"AC-684364022559 - TATUAJES VARIOS ",
"AC-011420112 - TAZA",
"AC-755244025229 - TETRIS SPEED",
"AG-8410779087201 - THE BEASTIES",
"AG-5010993973521 - THOR STORMBRAKER",
"T-TIC001 - TICKETS",
"AC-7501214907336 - TIJERAS",
"AG-6911400309881 - TIN CAR CARRO DE RADIO CONTROL ",
"AM-TOA091119F - TOALLA FULANITO",
"AC-7500383065120 - TOALLA HUMEDAS ANTIBACTERIAL",
"AM-JCA2945 - TORNEO DE MAGIA HARRY POTTER",
"AC-7502220419820 - TRACTOR GRANJA ",
"AM-MJSP2081 - TRAILER FRICCION SPIDERMAN",
"AG-KM245 - TRAILER TAKE A PART",
"AG-027084717105 - TRAILERS CARS PAQUETE",
"AC-TR202176 - TRENZITA PARA NI√ëAS",
"AC-7501969795509 - TROMPO CON LUZ VARIOS PERSONAJES",
"AC-TY202629MX - TROMPO DISNEY",
"AD-603554043051 - TRUENO POP",
"AM-655244016654 - TURISTA MARVEL",
"AM-7501075202274 - TURISTA MUNDIAL GRANDE",
"AG-032244046452 - TWISTER",
"AM-778988544235 - TWISTY PETS",
"AG-6044183 - UNICORNIO ATRAPA AROS",
"AG-FZ2212 - UNICORNIO KAWAI",
"AD-754177507588 - UNICORNIO WINIS",
"AC-078206010017 - UNO CARTAS ",
"AC-RB03149 - VAHICULOS EMERGENCIA SET ",
"AC-6014100 - VASO HELADO ",
"AM-778988553480 - VEHICULO MOSNTER JAM",
"AG-630509970315 - VIDEO JUEGO DE BOLSILLO ",
"AG-J8273643865 - VIDEO JUEGO DE BOLSILLO SONIC ",
"AG-RC85 - WAFFLERA",
"AG-2019060700377 - WINDOW ART",
"AD-754177303005 - WINIS",
"AD-073390018382  - XTREMES CHUPA CHUPS",
"AD-703885005220 - ZUMBA MANGO",
"AD-018804059049 - PALETA ICEE ",
"AD-018804701054 - JELLY BEANS",
"AD-6936756250861 - GOMITAS OJOS",
"AD-840004010885 - BONDY SKATE",
"AD-603554019209 - TRUENO HUEVITO",
"AD-7501325601864 - NAVIDAD MALVAVISCO",
"AD-840004031934 - RELOJ KITTY",
"AD-812999010256 - JUGOS FRUTRAS",
"AD-018804701054 - JELLY BEANS",
"AD-739944007140 - OBLEAS DE CAJETA",
"AD-7503005322083 - BASTONCITOS NAVIDENOS",
"AD-840004027333 - TAWENO ICEE",
"AD-02073061 - FROSH VARITA",
"AD-1880470151 - ICEE OSITOS GOMITAS",
"AD-6936756261348 - GOMITAS MANGO PELA ",
"G-04003100 - MM CHOCOLATE",
"G-04003207 - MM AMARILLO",
"G-04010207 - SNICKERS",
"G-04010100 - MILKY WAY",
"G-400003319 - SKITTLES",
"G-7898024397915 - NUTELLA B READY",
"G-7501024513628 - HERSHEYS",
"G-054800490061 - KIT KAT",
"F-REF600 - REFRESCO DE 600 ML",
"F-03673150100 - GATORADE/POWERADE",
"F-751055330683 - VALLE FRUIT",
"F-75007614 - COCA COLA 600 ML.",
"F-7501055307906 - AGUA CIEL 600 ML.",
"F-0070847035916 - MONSTER ",
"F-75000820 - JUGO DEL VALLE",

    # Agrega m√°s productos si es necesario
]

# Inicializar sesi√≥n para almacenamiento temporal
if "data" not in st.session_state:
    st.session_state.data = pd.DataFrame(columns=[
        "C√≥digo", "Producto", "Cantidad", "Precio Unitario", "Fecha",
        "C√≥digo Almac√©n", "Local", "Incluye IVA"
    ])

# T√≠tulo
st.title("Generador de Layout para Microsoft Dynamics")

# Selecci√≥n de m√©todo
option = st.radio("¬øC√≥mo quieres ingresar los productos?", ("Captura manual", "Cargar archivo Excel"))

if option == "Captura manual":
    with st.form("form_productos"):
        producto_completo = st.selectbox(
            "üîç Selecciona un producto (c√≥digo - nombre):",
            options=productos,
            index=None,
            placeholder="Escribe parte del c√≥digo o nombre..."
        )
        codigo_almacen = st.text_input("C√≥digo de almac√©n")
        local = st.selectbox("Selecciona el local", options=["COAPA"])
        cantidad = st.number_input("Cantidad", min_value=1, step=1)
        precio = st.number_input("Precio Unitario", min_value=0.01, step=0.01)
        incluye_iva = st.checkbox("¬øEl producto incluye IVA?")
        fecha = st.date_input("Fecha de compra", value=datetime.today())
        submitted = st.form_submit_button("Agregar")

        if submitted:
            if producto_completo:
                codigo, nombre = producto_completo.split(" - ", 1)
                if incluye_iva:
                    precio_total = precio * 1.16
                else:
                    precio_total = precio
                new_row = {
                    "C√≥digo": codigo.strip(),
                    "Producto": nombre.strip(),
                    "Cantidad": cantidad,
                    "Precio Unitario": precio_total,
                    "Fecha": fecha,
                    "C√≥digo Almac√©n": codigo_almacen.strip(),
                    "Local": local,
                    "Incluye IVA": "S√≠" if incluye_iva else "No"
                }
                st.session_state.data = pd.concat([st.session_state.data, pd.DataFrame([new_row])], ignore_index=True)
                st.success("Producto agregado correctamente.")
            else:
                st.warning("Por favor selecciona un producto v√°lido.")

elif option == "Cargar archivo Excel":
    uploaded_file = st.file_uploader("Cargar archivo Excel", type=["xlsx"])
    if uploaded_file:
        try:
            df = pd.read_excel(uploaded_file)
            required_cols = ["C√≥digo", "Producto", "Cantidad", "Precio Unitario", "Fecha", "C√≥digo Almac√©n", "Local"]
            if all(col in df.columns for col in required_cols):
                st.session_state.data = df
                st.success("Archivo cargado correctamente.")
            else:
                st.error("El archivo debe contener las columnas: C√≥digo, Producto, Cantidad, Precio Unitario, Fecha, C√≥digo Almac√©n, Local")
        except Exception as e:
            st.error(f"Error al leer el archivo: {e}")

# Mostrar vista previa si hay datos
if not st.session_state.data.empty:
    df = st.session_state.data.copy()
    df["Fecha"] = pd.to_datetime(df["Fecha"], errors="coerce")

    if df["Fecha"].isnull().any():
        st.error("Hay fechas inv√°lidas en los datos. Verifica el formato de la columna 'Fecha'.")
    else:
        df["Costo Extendido"] = df["Cantidad"] * df["Precio Unitario"]

        st.subheader("üìã Vista previa de los productos capturados")
        st.dataframe(df)

        if st.button("üìù Generar archivo layout_dynamics.xlsx"):
            layout = pd.DataFrame()
            layout["A"] = df["C√≥digo"]
            layout["B"] = df["C√≥digo Almac√©n"]
            layout["C"] = df["Cantidad"]
            layout["D"] = ""
            layout["E"] = ""
            layout["F"] = df["Costo Extendido"]
            layout["G"] = ""
            layout["H"] = ""
            layout["I"] = ""
            layout["J"] = ""
            layout["K"] = df["Fecha"].dt.strftime("%d/%m/%Y")
            layout["L"] = df["Fecha"].dt.strftime("%d/%m/%Y")
            for col in ["M", "N", "O", "P", "Q", "R", "S", "T"]:
                layout[col] = ""
            layout["U"] = df["Producto"]
            layout["V"] = df["Local"]

            output_path = os.path.join(SAVE_FOLDER, "layout_dynamics.xlsx")
            layout.to_excel(output_path, index=False, engine="openpyxl")
            st.success(f"Archivo guardado en: {output_path}")
            with open(output_path, "rb") as f:
                st.download_button("‚¨áÔ∏è Descargar archivo", f, file_name="layout_dynamics.xlsx")

    if st.button("üóëÔ∏è Limpiar datos capturados"):
        st.session_state.data = pd.DataFrame(columns=[
            "C√≥digo", "Producto", "Cantidad", "Precio Unitario", "Fecha",
            "C√≥digo Almac√©n", "Local", "Incluye IVA"
        ])
        st.success("Datos limpiados.")
